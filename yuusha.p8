pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
--init
function _init()
	in_menu=false
	plyr={x=7, y=7}
	plyr.name="goblo"
	plyr.hp=10
	plyr.mp=0
	plyr.gold=0
	plyr.spr=1 --current plyr anim sprite
	plyr.sprl=2 --number of frames in plyr anim
	
	cellsize=8
	pstatx=1*cellsize --plyr stats menu x
	pstaty=1*cellsize --plyr stats menu y
	pstatw=5*cellsize --plyr stats menu width
	pstath=6*cellsize --plyr stats menu height
	txtoffsetx=4 --x offset of menu text
	txtoffsety=4 --y offset of menu text
end
-->8
--menu
function open_menu()
	in_menu = not in_menu
	if in_menu then
		sfx(0)
	else
		sfx(1)
	end
end

function draw_menu()
	if not in_menu then return end
	
	draw_pstats()
end

function draw_pstats()
	--draw menu bg
	--top row
	spr(64,pstatx,pstaty)
	for w=pstatx+1,pstatx+pstatw-1,cellsize do
		spr(65,w,pstaty)	
	end
	spr(66,pstatx+pstatw,pstaty)
	
	--middle rows
	for h=pstaty+1,pstaty+pstath-1,cellsize do
		spr(67,pstatx,h)
		for w=pstatx+1,pstatx+pstatw-1,cellsize do
			spr(72,w,h)
		end
		spr(68,pstatx+pstatw,h)
	end
	
	--bottom row
	--there's something wrong;
	--try commenting out inner loop
	spr(69,pstatx,pstaty+pstath)
		for x=pstatx+1,pstatx+pstatw-1,cellsize do
			spr(70,x,pstaty+pstath)
		end
	spr(71,pstatx+pstatw,pstaty+pstath)

	--print text
	print(plyr.name, pstatx+txtoffsetx, pstaty+txtoffsety)
	print("hp				"..plyr.hp,pstatx+txtoffsetx,(2*pstaty)+txtoffsety)
	print("mp				"..plyr.mp,pstatx+txtoffsetx,(3*pstaty)+txtoffsety)
	print("gold		"..plyr.gold,pstatx+txtoffsetx,(4*pstaty)+txtoffsety)
	--print("time		"..time(),pstatx+txtoffsetx,(5*pstaty)+txtoffsety)
end

-->8
--update()
function _update()
	--moving player
	move_player()
	if btnp(4) then open_menu() end
end
-->8
--draw()
function _draw()
	map(0,0,0,0,16,16)
	
	anim_plyr()
	spr(plyr.spr,plyr.x*cellsize,plyr.y*cellsize)
	draw_menu()
end

-->8
--player
function move_player()
	if in_menu then return end
	if btnp(0) then plyr.x-=1 end
	if btnp(1) then plyr.x+=1 end
	if btnp(2) then plyr.y-=1 end
	if btnp(3) then plyr.y+=1 end
end

function anim_plyr()
	if time()%0.5==0 then
		plyr.spr+=1
	end
	if plyr.spr>plyr.sprl then
		plyr.spr=1
	end
end



__gfx__
00000000800000088000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000008cccccc88cccccc800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007008cccccc88cccccc800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000c5ff5c00c5ff5c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000cffffc00cffffc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700001111d00d11110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000dcccc0000ccccd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000dd11000011dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222222222222221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122111111111111111111111121111111100000000000000000000000000000000000000000000000000000000
21111111111111111111111221111111111111122222222222222222222222221111111100000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333333333333333333333333433334343333344443333333333333356666665333300000000000000000000000000000000000000000000000000000000
33333333333333349333333333334443333434333344443333333333333356666665333300000000000000000000000000000000000000000000000000000000
33333333333333449933333333344444334343333344444443434343333355566555444400000000000000000000000000000000000000000000000000000000
33333333333334424993333333334243333434333344444434343434333356666665444400000000000000000000000000000000000000000000000000000000
33333333333344242499333333433333334343333344444443434343333356666665444400000000000000000000000000000000000000000000000000000000
33333333333442444249933334443333333434333344444434343434333356556665444400000000000000000000000000000000000000000000000000000000
33333333334424444424993344444333334343333344443333333333333356665565333300000000000000000000000000000000000000000000000000000000
33333333344244444442499334243333333434333344443333333333333356666665333300000000000000000000000000000000000000000000000000000000
33333333342444444444244333b33333333333333333333366666666333333330000000000000000000000000000000000000000000000000000000000000000
33b3333333244444444442333bbb3333333333333333333366566556333333330000000000000000000000000000000000000000000000000000000000000000
3b3b333333244444444444333bbb3333333333333333333366556666333333330000000000000000000000000000000000000000000000000000000000000000
33333333332444499444443333433333333333333333333366666666333333330000000000000000000000000000000000000000000000000000000000000000
33333333332444499444443333333b33333356565656333366666666333333330000000000000000000000000000000000000000000000000000000000000000
33333b3333244449944444333333bbb3333365656565333365566666333333330000000000000000000000000000000000000000000000000000000000000000
3333b3b333222229922222333333bbb3333356565656333366666566333333330000000000000000000000000000000000000000000000000000000000000000
33333333333333333333333333333433333365656565333366665566333333330000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333356565656333333444433666665560000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333365656565333333444433655666660000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333356565656333333444433666666660000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333365656565333333444433555555550000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333333333333333355555555334444330000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333333333333333366666666334444330000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333333333333333366666666334444330000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000333333333333333366666666334444330000000000000000000000000000000000000000000000000000000000000000
__map__
8090808080808080848080809080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9093908080908080848093909080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9393939080808380848083838090808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9393939080838394a69580838080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9393939390838387968886868686868680808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
93939390808383a4a7a583808093908080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9393939080808383849080838090938080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9093909080809080848083809090908080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8090908080808080848080808080908080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080848080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080848080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080848080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080848080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080848080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8080808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
010500001c5502c500285502c5002c500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500005000050000500
0105000028550000001c5500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01100000180501a0501c0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
